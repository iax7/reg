<%= form_for(@person, html: {class:'form-horizontal', role:'form'}) do |f| %>

  <div class="form-group"><%= f.label :name, class: 'control-label col-sm-2' %>    <div class='col-sm-6'><%= f.text_field :name, class: 'form-control input-sm' %></div></div>
  <div class="form-group"><%= f.label :lastname, class: 'control-label col-sm-2' %><div class='col-sm-6'><%= f.text_field :lastname, class: 'form-control input-sm' %></div></div>
  <div class="form-group"><%= f.label :nickname, class: 'control-label col-sm-2' %><div class='col-sm-6'><%= f.text_field :nickname, placeholder: 'Aparecerá en el gafete impreso', class: 'form-control input-sm' %></div></div>
  <div class="form-group"><%= f.label :age,      class: 'control-label col-sm-2' %><div class='col-sm-2'><%= f.number_field :age,    class: 'form-control input-sm', min: 0 %></div></div>
  <div class="form-group"><%= f.label :email, class: 'control-label col-sm-2' %>   <div class='col-sm-6'><%= f.email_field :email, class: 'form-control input-sm' %>
    <i class="fa fa-exclamation-triangle text-danger"></i> Revisa bien tu correo, es tu nombre de usuario para seguir usando este sistema. No se permite duplicar el correo para otro registro.</div></div>
  <% if @person.id.nil? %>
  <div class="form-group"><%= f.label :password, class: 'control-label col-sm-2' %><div class='col-sm-4'><%= f.password_field :password, id: 'pass1', class: 'form-control input-sm' %></div></div>
  <div class="form-group has-feedback" id="pass2grp"><%= f.label :password_confirmation, class: 'control-label col-sm-2' %><div class='col-sm-4'>
     <%= f.password_field :password_confirmation, id: 'pass2', class: 'form-control input-sm' %>
     <span class="glyphicon form-control-feedback" id="pass2icon" aria-hidden="true"></span>
     <span id="inputSuccess2Status" class="sr-only">(success)</span>
  </div></div>
  <% end %>
  <div class="form-group"><%= f.label :phone, class: 'control-label col-sm-2' %>   <div class='col-sm-3'><%= f.text_field :phone, class: 'form-control input-sm' %></div></div>
  <div class="form-group"><%= f.label :ismale, class: 'control-label col-sm-2' %>  <div class='col-sm-2'><%= f.select :ismale, [['Hombre', true], ['Mujer', false]], {}, { class: 'form-control input-sm'} %></div></div>
  <div class="form-group"><%= f.label :church, class: 'control-label col-sm-2' %>  <div class='col-sm-6'><%= f.autocomplete_field :church, autocomplete_church_name_people_path, data: {autocomplete_label: 'No encontré coincidencias.' }, class: 'form-control input-sm ui-autocomplete-input' %></div></div>
  <div class="form-group"><%= f.label :country, class: 'control-label col-sm-2' %> <div class='col-sm-6'><%= f.autocomplete_field :country, autocomplete_country_name_people_path, data: {autocomplete_label: 'No encontré coincidencias.' }, class: 'form-control input-sm ui-autocomplete-input' %></div></div>
  <div class="form-group"><%= f.label :state, class: 'control-label col-sm-2' %>   <div class='col-sm-6'><%= f.text_field :state, class: 'form-control input-sm ui-autocomplete-input', type: 'search', data: {autocomplete: autocomplete_state_name_people_path, autocomplete_label: 'No encontré coincidencias.'} %></div></div>
  <div class="form-group"><%= f.label :city, class: 'control-label col-sm-2' %>    <div class='col-sm-6'><%= f.text_field :city, class: 'form-control input-sm' %></div></div>
  <div class="form-group"><%= f.label :assist_v, class: 'control-label col-sm-2' %>
    <div class='col-sm-8'>¿Qué días estarás asistiendo la conferencia?
      <table class="table table-condensed">
        <thead>
          <tr>
            <th class="text-center viernes-text">Viernes</th>
            <th class="text-center sabado-text">Sábado</th>
            <th class="text-center domingo-text">Domingo</th>
            <th class="text-center lunes-text">Lunes</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><%= f.check_box :assist_v, class: 'form-control input-sm' %></td>
            <td><%= f.check_box :assist_s, class: 'form-control input-sm' %></td>
            <td><%= f.check_box :assist_d, class: 'form-control input-sm' %></td>
            <td><%= f.check_box :assist_l, class: 'form-control input-sm' %></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div class="form-group"><%= f.label :comments, class: 'control-label col-sm-2' %>
    <div class='col-sm-8'>
      Preguntas / Otras indicaciones (si no, deja este espacio en blanco)
      <%= f.text_area :comments, rows: '3', class: 'form-control input-sm' %></div></div>

  <% if @person.errors.any? %>
    <div class="alert alert-danger no-border">
      <h3><%= pluralize(@person.errors.count, 'error impidió', 'errores impidieron') %> que se guardara el registro:</h3>

      <ul>
      <% @person.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-6">
        <div id="actions">
          <%= f.submit 'Aceptar', data: { disable_with: 'Procesando...' }, class: 'btn btn-sm btn-primary', id: 'submit_ajax' %>
          <%= link_to 'Cancelar', get_start, { class: 'btn btn-sm btn-link' }  %>
        </div>
        <%= image_tag image_path('spinner.gif'), id: 'spinner', style: 'display:none', alt: 'Waiting...' %>
      </div>
    </div>
<% end %>
<br>
<script>
    $('#submit_ajax').click(function(){
        $('#spinner').show();
        $('#actions').hide();
    });

    $('.ui-autocomplete-input')
        .focusout( function() {
                text = $(this).val();
                if (text == 'no existing match') {
                    $(this).val('');
                }
            });

    $('#pass2').keyup(function(){
        var pass1 = $('#pass1').val();
        var pass2 = $('#pass2').val();
        if (pass1 == pass2) {
            $('#pass2icon').removeClass().addClass('glyphicon form-control-feedback glyphicon-ok text-success');
        } else {
            $('#pass2icon').removeClass().addClass('glyphicon form-control-feedback glyphicon-remove text-danger');
        }
    });
</script>
